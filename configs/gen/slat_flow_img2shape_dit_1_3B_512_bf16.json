{
    "models": {
        "denoiser": {
            "name": "ElasticSLatFlowModel",
            "args": {
                "resolution": 32,
                "in_channels": 32,
                "out_channels": 32,
                "model_channels": 1536,
                "cond_channels": 1024,
                "num_blocks": 30,
                "num_heads": 12,
                "mlp_ratio": 5.3334,
                "pe_mode": "rope",
                "share_mod": true,
                "initialization": "scaled",
                "qk_rms_norm": true,
                "qk_rms_norm_cross": true
            }
        }
    },
    "dataset": {
        "name": "ImageConditionedSLatShape",
        "args": {
            "resolution": 512,
            "image_size": 512,
            "min_aesthetic_score": 4.5,
            "max_tokens": 8192,
            "normalization": {
                "mean": [
                    0.781296, 0.018091, -0.495192, -0.558457, 1.060530, 0.093252, 1.518149, -0.933218,
                    -0.732996, 2.604095, -0.118341, -2.143904, 0.495076, -2.179512, -2.130751, -0.996944,
                    0.261421, -2.217463, 1.260067, -0.150213, 3.790713, 1.481266, -1.046058, -1.523667,
                    -0.059621, 2.220780, 1.621212, 0.877230, 0.567247, -3.175944, -3.186688, 1.578665
                ],
                "std": [
                    5.972266, 4.706852, 5.445010, 5.209927, 5.320220, 4.547237, 5.020802, 5.444004,
                    5.226681, 5.683095, 4.831436, 5.286469, 5.652043, 5.367606, 5.525084, 4.730578,
                    4.805265, 5.124013, 5.530808, 5.619001, 5.103930, 5.417670, 5.269677, 5.547194,
                    5.634698, 5.235274, 6.110351, 5.511298, 6.237273, 4.879207, 5.347008, 5.405691
                ]
            },
            "pretrained_slat_dec": "microsoft/TRELLIS.2-4B/ckpts/shape_dec_next_dc_f16c32_fp16"
        }
    },
    "trainer": {
        "name": "ImageConditionedSparseFlowMatchingCFGTrainer",
        "args": {
            "max_steps": 1000000,
            "batch_size_per_gpu": 8,
            "batch_split": 2,
            "optimizer": {
                "name": "AdamW",
                "args": {
                    "lr": 1e-4,
                    "weight_decay": 0.01,
                    "betas": [0.9, 0.95],
                    "eps": 1e-8
                }
            },
            "ema_rate": [
                0.9999
            ],
            "mix_precision_mode": "amp",
            "mix_precision_dtype": "bfloat16",
            "elastic": {
                "name": "LinearMemoryController",
                "args": {
                    "target_ratio": 0.75,
                    "max_mem_ratio_start": 0.5
                }
            },
            "grad_clip": {
                "name": "AdaptiveGradClipper",
                "args": {
                    "max_norm": 1.0,
                    "clip_percentile": 95
                }
            },
            "i_log": 500,
            "i_sample": 10000,
            "i_save": 10000,
            "p_uncond": 0.1,
            "t_schedule": {
                "name": "uniform",
                "args": {}
            },
            "sigma_min": 1e-5,
            "image_cond_model": {
                "name": "DinoV3FeatureExtractor",
                "args": {
                    "model_name": "facebook/dinov3-vitl16-pretrain-lvd1689m",
                    "image_size": 512
                }
            }
        }
    }
}